<!DOCTYPE html>
<html lang="eng">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Results</title>
    <link rel="stylesheet" href="Resultts-page-style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>

<body>
    <div class="info">
        <h1>Results</h1>
    </div>

    <div class="coursesbody">
        <p>Trail status: none</p>
        <div class="navigator">
            <button onclick="goPrevious()">Previous</button>
            <span id="display">Year 1 - Semester 1</span>
            <button onclick="goNext()">Next</button>
        </div>
        <div id="results-area"></div>
        <div class="payment-link">
            <button id="download-results">Download results <i class="fas fa-download"></i></button>
        </div>
    </div>
    <script>
        const resultsData = {
            "Year 1": {
                "Semester 1": [
                    {
                        grade: "A",
                        courseName: "Introduction to Programming",
                        score: "70%",
                        lecturer: "Dr. Smith",
                        creditHours: 3,
                        link: "../course-body/Coursebody.html?id=1"
                    },
                    {
                        grade: "B",
                        courseName: "Introduction to Programming",
                        score: "65%",
                        lecturer: "Mr. Kwame Osei",
                        creditHours: 3,
                        link: "../course-body/Course(no).html?id=2"
                    },

                ],
                "Semester 2": []
            },
            "Year 2": {
                "Semester 1": [],
                "Semester 2": []
            },
            "Year 3": {
                "Semester 1": [],
                "Semester 2": []
            },
            "Year 4": {
                "Semester 1": [],
                "Semester 2": []
            }
        };
        const years = ["Year 1", "Year 2", "Year 3", "Year 4"];
        const semesters = ["Semester 1", "Semester 2"];
        let currentYearIndex = 0;
        let currentSemesterIndex = 0;

        function updateDisplay() {
            const display = document.getElementById("display");
            const resultsArea = document.getElementById("results-area");
            const year = years[currentYearIndex];
            const semester = semesters[currentSemesterIndex];

            display.textContent = `${year} - ${semester}`;

            const results = resultsData[year]?.[semester];

            if (results && results.length > 0) {
                resultsArea.innerHTML = results.map(result => `
      <div class="results-container">
        <a href="${result.link}" class="course-link">
          <div id="grade">${result.grade}</div>
          <div id="course-name">${result.courseName}</div>
          <div id="score">${result.score}</div>
          <div id="lecturer">${result.lecturer}</div>
          <div id="credit-hours">Credit-hours: ${result.creditHours}</div>
        </a>
      </div>
    `).join("");
            } else {
                resultsArea.innerHTML = `
      <div class="results-container">
        <p style="text-align:center; font-size:18px; font-weight:bold; color:#999;">
          No results available for ${year} ${semester}.
        </p>
      </div>
    `;
            }
        }

        function goNext() {
            currentSemesterIndex++;
            if (currentSemesterIndex >= semesters.length) {
                currentSemesterIndex = 0;
                currentYearIndex++;
                if (currentYearIndex >= years.length) {
                    currentYearIndex = 0;
                }
            }
            updateDisplay();
        }

        function goPrevious() {
            currentSemesterIndex--;
            if (currentSemesterIndex < 0) {
                currentSemesterIndex = semesters.length - 1;
                currentYearIndex--;
                if (currentYearIndex < 0) {
                    currentYearIndex = years.length - 1;
                }
            }
            updateDisplay();
        }

        window.onload = updateDisplay;
        document.getElementById("download-results").addEventListener("click", () => {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            const year = years[currentYearIndex];
            const semester = semesters[currentSemesterIndex];
            const results = resultsData[year]?.[semester];

            doc.setFontSize(16);
            doc.text(`Results - ${year} ${semester}`, 20, 20);

            if (results && results.length > 0) {
                let y = 30;
                results.forEach((result, index) => {
                    doc.setFontSize(12);
                    doc.text(`Course ${index + 1}: ${result.courseName}`, 20, y);
                    doc.text(`Grade: ${result.grade}`, 20, y + 8);
                    doc.text(`Score: ${result.score}`, 20, y + 16);
                    doc.text(`Lecturer: ${result.lecturer}`, 20, y + 24);
                    doc.text(`Credit Hours: ${result.creditHours}`, 20, y + 32);
                    y += 42;
                });
            } else {
                doc.setFontSize(12);
                doc.text(`No results available for ${year} ${semester}.`, 20, 30);
            }

            doc.save(`Results_${year}_${semester}.pdf`);
        });
    </script>
</body>

</html>